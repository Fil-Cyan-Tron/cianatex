%Requires texlive 2024
\ProvidesPackage{cianatex}

%Pacchetti

    %Layout pagina
        \usepackage[a4paper, margin=15mm]{geometry}

    %Roba per la lingua
        %codifica del testo
            \RequirePackage[utf8]{inputenc}
        %font italiani
            \RequirePackage[T1]{fontenc}
        %elementi di linguaggio
            \RequirePackage[italian]{babel}

    %TODO: pacchetti per le immagini (per ora frega sega)

    %Plots
        \RequirePackage{tikz}
        \RequirePackage{tikz-3dplot}

    %Disegnini di Drago
        \RequirePackage{phaistos}

    %Ambienti
        %Box colorate
            \RequirePackage[most]{tcolorbox}
            \tcbuselibrary{theorems}
            \tcbuselibrary{skins}

    %Tabelle
        %Tabelle di base
            \RequirePackage{array}
        %Tabelle grosse
            \RequirePackage{longtable}
        %Dimensionamento delle colonne
            \RequirePackage{multirow}
        %Multicolonne
            \RequirePackage{multicol}

    %Diagrammi commutativi
        \RequirePackage{quiver}
        \usetikzlibrary{nfold}

    %Disegnini
        \usetikzlibrary{patterns}

    %Collegamenti
        %Url cliccabili
            \RequirePackage{url}
        %Tavole dei contenuti et cetera
            \RequirePackage{hyperref}

    %ICONE FIGHISSIME
        \RequirePackage{rpgicons}

    %Codice
        \RequirePackage{listings}

    %Bibliografia
        %Quotes
            \RequirePackage{csquotes}
        %Bibliografia
            \RequirePackage[backend=biber, sorting=ydnt, bibstyle=ieee]{biblatex}
        %Citazioni lapidare
            \RequirePackage{epigraph}
        %Titolame
            \RequirePackage{titling}

    %Simboli e font
        %I vari simboli degli insiemi numerici
            \RequirePackage{amsfonts}
        %Coefficienti binomiali
            \RequirePackage{amsmath}
        %Insieme vuoto per davvero con \varnothing che poi rinominiamo in \vuoto
            \RequirePackage{amssymb}
        %Arco con \wideparen{AB}
            \RequirePackage{yhmath}
        %Testo barrato
            \RequirePackage{cancel}
        %Integrali bizzarri tipo \fint
            \RequirePackage{esint}
        %Elfico
            \RequirePackage{tengwarscript}

%Opzioni

    %Colorcoding
    
        %Standard https://colorkit.co/palette/ff595e-ff924c-ffca3a-c5ca30-8ac926-52a675-1982c4-4267ac-6a4c93/
            \definecolor{definitioncolor}{HTML}{ff595e} %Rosso
            \definecolor{examplecolor}{HTML}{ff924c} %Arancio
            \definecolor{propositioncolor}{HTML}{8ac926} %Verde
            \definecolor{theoremcolor}{HTML}{1982c4} %Azzurro
            \definecolor{remarkcolor}{HTML}{6a4c93} %Viola
            \definecolor{notationcolor}{HTML}{404040} %Grigio
            \definecolor{corollarycolor}{HTML}{52a675} %Verde cobalto
            \definecolor{lemmacolor}{HTML}{4267ac} %Bluastro-ciano

        %Grigio depresso
            \DeclareOption{depression}{
                \definecolor{theoremcolor}{HTML}{404040}
                \definecolor{proofcolor}{HTML}{404040}
                \definecolor{definitioncolor}{HTML}{404040}
                \definecolor{propositioncolor}{HTML}{404040}
                \definecolor{remarkcolor}{HTML}{404040}
                \definecolor{examplecolor}{HTML}{404040}
                \definecolor{notationcolor}{HTML}{404040}
                \definecolor{corollarycolor}{HTML}{404040}
                \definecolor{lemmacolor}{HTML}{404040}
            }

        %Zun
            \DeclareOption{zun}{
                \definecolor{theoremcolor}{HTML}{C8D6FD}
                \definecolor{proofcolor}{HTML}{C8D6FD}
                \definecolor{definitioncolor}{HTML}{C8D6FD}
                \definecolor{propositioncolor}{HTML}{C8D6FD}
                \definecolor{remarkcolor}{HTML}{C8D6FD}
                \definecolor{examplecolor}{HTML}{C8D6FD}
                \definecolor{notationcolor}{HTML}{C8D6FD}
            }

\ProcessOptions\relax

%Roba nuova per davvero
    %roba basic
        %Emph più bellino
            \newcommand{\bemph}[1]{\textbf{\emph{#1}}}
        %Insieme vuoto bello
            \newcommand\vuoto\varnothing
            \renewcommand\emptyset\vuoto
        %Simbolo del parallelismo
            \newcommand\parallelo{{/\!/}}
        %Mcd
            \newcommand\mcd{\operatorname{mcd}}
        %Tette, tette iperboliche e arcotette in italiano
            \newcommand\sen{\operatorname{sen}}
            \renewcommand\sin\sen
            \newcommand\senh{\operatorname{senh}}
            \renewcommand\sinh\senh
            \newcommand\arcsen{\operatorname{arcsen}}
            \renewcommand\arcsin\arcsen
        %Tangentopoli, cotangentopoli, arcotangentopoli e arcocotangentopoli con la tg
            \newcommand\tg{\operatorname{tg}}
            \newcommand\cotg{\operatorname{cotg}}
            \newcommand\arctg{\operatorname{arctg}}
            \newcommand\arccotg{\operatorname{arccotg}}
        %Parti immaginarie e reali
            \renewcommand\Im{\operatorname{Im}}
            \renewcommand\Re{\operatorname{Re}}
        %Dominio
            \newcommand\dom{\operatorname{dom}}
        %Rango
            \newcommand\rk{\operatorname{rk}}
        %Grado
            \renewcommand\deg{\operatorname{deg}}
        %Sottostrutture e sovrastrutture
            \newcommand\substruct\vartriangleleft
            \newcommand\superstruct\vartriangleright
        %Implicazioni
            \newcommand\Harr\Leftrightarrow
            \newcommand\Rarr\Rightarrow
            \newcommand\Larr\Leftarrow
        %Definizione della funzione bella bella, gli argomenti sono [nome, dominio, codominio, variabile, funzione]
            \newcommand{\definefunction}[5]{
                \begin{array}{cccc}
                    #1 :  & #2 & \longrightarrow & #3\\
                    \quad & #4 &   \longmapsto   & #5
                \end{array}
                }
        %Insiemi numerici
            \newcommand\N{\mathbb{N}} %Naturali
            \newcommand\Z{\mathbb{Z}} %Interi
            \newcommand\Q{\mathbb{Q}} %Razionali
            \newcommand\R{\mathbb{R}} %Reali
            \newcommand\C{\mathbb{C}} %Complessi
        %Entità algebriche
            \newcommand\K{\mathbb{K}} %Campi in geometria
            \newcommand\F{\mathbb{F}} %Campi in algebra
            \newcommand\G{\mathcal{G}} %Gruppi, occasionalmente
        %Entità geometriche
            \newcommand\A{\mathbb{A}} %Spazi affini, anelli occasionalmente
            \renewcommand\P{\mathbb{P}} %Spazi proiettivi
            \newcommand\E{\mathbb{E}} %Spazi euclidei
        %Misure
            \renewcommand\L{\mathcal{L}} %Misura di Lebesgue, o pre-spazio L
            \renewcommand\H{\mathcal{H}} %Misura di Hausdorff
        %Intorni
            \newcommand\U{\mathcal{U}}
            \newcommand\V{\mathcal{V}}
        %Altro
            \newcommand\parti{\mathcal{P}} %Insieme delle parti
            \newcommand\B{\mathcal{B}} %Boreliani
            \newcommand{\comp}{\mathcal{K}} %Compatti 
            \newcommand\M{\mathcal{M}} %Misurabili 
            \newcommand{\tribu}{\mathcal{F}} %Tribù in probabilità
            \newcommand{\bin}[2]{\begin{pmatrix} #1 \\ #2 \end{pmatrix}} %Coefficiente binomiale
            \newcommand\de{\text{ d}} %d per gli integrali
            \newcommand\di{\text{d}} %d per le derivate totali
            \newcommand\inj{\hookrightarrow} %iniezione
            \newcommand\jni{\hookleftarrow} %iniezione dall'altra parte
            \newcommand\sur{\twoheadrightarrow} %suriezione
            \newcommand\rus{\twoheadleftarrow} %suriezione dall'altra parte
            \newcommand\supp{\operatorname{supp}} %supporto
            \newcommand\Nick{\ability[positive]{charisma}[frame=spellschool, scale=0.5]\:} %proof by nick drake
            \renewcommand\S{\mathbb{S}} %Sfera
            \newcommand\Loc{\operatorname{L}_{\text{loc}}}
            \newcommand\Twitter{\mathcal{X}}
            \newcommand\dist{\operatorname{dist}}
        %Variabili aleatorie
            %Discrete
                \newcommand\binva{\operatorname{bin}}
                \newcommand\poisva{\operatorname{pois}}
                \newcommand\geomva{\operatorname{geom}}
                \newcommand\hyperva{\operatorname{hyper}}
            %Assolutamente continue
                \newcommand\normva{\mathcal{N}}
                \newcommand\unifva{\operatorname{unif}}
                %exp, chi^2 e t esistono già
        %Shortcuts per mathcal, mathbb e mathbf
            \newcommand{\mc}[1]{\mathcal{#1}}
            \newcommand{\mbb}[1]{\mathbb{#1}}
            \newcommand{\mbf}[1]{\mathbf{#1}}
            \newcommand{\mfk}[1]{\mathfrak{#1}}
        %Categories
            \newcommand\mor{\operatorname{mor}}
            \newcommand\ob{\operatorname{ob}}
            \newcommand{\catname}[1]{\text{\sffamily\textbf{#1}}}
            \newcommand\setcat{\catname{Set}}
            \newcommand\topcat{\catname{Top}}
            \newcommand\grpcat{\catname{Grp}}
            \newcommand\modcat{\catname{Mod}}
            \newcommand\veccat{\catname{Vec}}
            \newcommand\algcat{\catname{Alg}}
            \newcommand\fldcat{\catname{Fld}}
            \newcommand\ringcat{\catname{Ring}}
            \newcommand\graphcat{\catname{Graph}}
            \newcommand\mblecat{\catname{Mble}}
            \newcommand\meascat{\catname{Meas}}
            \newcommand\posetcat{\catname{PoSet}}
            \newcommand\id{\operatorname{id}}
            \newcommand\catcat{\catname{cat}}
            \newcommand\op{\catname{op}}
            \newcommand\mono\inj
            \newcommand\epi\sur
            \newcommand\cone{\catname{Cone}}
            \newcommand\Catcat{\catname{Cat}}
            \newcommand\CATcat{\catname{CAT}}
            \newcommand\catlim{\lim_{\leftarrow}}
            \newcommand\catcolim{\lim_{\rightarrow}}

            \newcommand\FLT{\mfk{F}\mc{L}\mbb{T}}
    %Ambienti

        %Teoremi, proposizioni et cetera
        
        \newcommand\proof{\tcbsubtitle[before skip=\baselineskip]{Dimostrazione}}
        \newcommand\solution{\tcbsubtitle[before skip=\baselineskip]{Soluzione}}
        \newcommand\qed{\begin{flushright}$\square$\end{flushright}}
        \newcommand\solved{\begin{flushright}\PHrosette\end{flushright}}

        \newtcbtheorem[number within=section]{theorem}{Teorema}{
            enhanced,
            breakable,
            colback=white,
            colframe=theoremcolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=theoremcolor!15!white, colupper=theoremcolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{th}
        \newtcbtheorem[number within=section]{definition}{Definizione}{
            enhanced,
            breakable,
            colback=white,
            colframe=definitioncolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=definitioncolor!15!white, colupper=definitioncolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{def}
        \newtcbtheorem[number within=section]{proposition}{Proposizione}{
            enhanced,
            breakable,
            colback=white,
            colframe=propositioncolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=propositioncolor!15!white, colupper=propositioncolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{prop}
        \newtcbtheorem[number within=section]{remark}{Osservazione}{
            enhanced,
            breakable,
            colback=white,
            colframe=remarkcolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=remarkcolor!15!white, colupper=remarkcolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{rem}
        \newtcbtheorem[number within=section]{example}{Esempio}{
            enhanced,
            breakable,
            colback=white,
            colframe=examplecolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=examplecolor!15!white, colupper=examplecolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{exmp}
        \newtcbtheorem[number within=section]{exercise}{Esercizio}{
            enhanced,
            breakable,
            colback=white,
            colframe=examplecolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=examplecolor!15!white, colupper=examplecolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{exc}
        \newtcbtheorem[number within=section]{corollary}{Corollario}{
            enhanced,
            breakable,
            colback=white,
            colframe=corollarycolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=corollarycolor!15!white, colupper=corollarycolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{corol}
        \newtcbtheorem[number within=section]{notation}{Notazione}{
            enhanced,
            breakable,
            colback=white,
            colframe=notationcolor,
            fonttitle=\bfseries,
            sharp corners,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{notaz}
        \newtcbtheorem[number within=section]{situation}{Situazione}{
            enhanced,
            breakable,
            colback=white,
            colframe=notationcolor,
            fonttitle=\bfseries,
            sharp corners,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{situaz}
        \newtcbtheorem[number within=section]{lemma}{Lemma}{
            enhanced,
            breakable,
            colback=white,
            colframe=lemmacolor,
            fonttitle=\bfseries,
            subtitle style={boxrule=1pt, colback=lemmacolor!15!white, colupper=lemmacolor},
            sharp corners,
            upperbox=visible,
            lowerbox=visible,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{lem}
        \newtcbtheorem[number within=section]{axiom}{Assioma}{
            enhanced,
            breakable,
            colback=white,
            colframe=theoremcolor,
            fonttitle=\bfseries,
            sharp corners,
            rightrule=0pt,
            leftrule=2pt,
            bottomrule=0pt,
        }{ax}
